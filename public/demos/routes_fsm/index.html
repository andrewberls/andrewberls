<!DOCTYPE html>
<html>
  <head>
    <title>FSM</title>
    <link rel="stylesheet" href="reset.css" />
    <style>

      body {
        font-family: "Helvetica Neue", Helvetica, Arial, Sans-Serif;
        margin: 0;
      }

      h1 {
        font-size: 2.0em; font-weight: bold; text-align: center;
        color: white; background-color: black;
        padding: 5px 0;
        margin: 0 0 20px;
      }

      h2 {
        text-align: center;
        display: none;
        font-size: 0.5em;
      }

      div#chart-2 {
        height: 350px;
      }

      .clearfix {display: inline-block; }
      .input { overflow: show;}
      .instruction { color: #666; padding: 0 30px 20px; font-size: 0.9em}
      .instruction p { padding: 0 0 5px; }
      .instruction li { padding: 0 10px 5px; }

      .form { background: #EEE; padding: 20px 30px; border-radius: 5px; margin-left: auto; margin-right: auto; width: 500px; margin-bottom: 20px}
      .form p, .form form { text-align: center }
      .form form {padding: 0 10px 5px; }
      .form .fun_routes { font-size: 0.9em;}
      .form .fun_routes a { margin: 0 5px 0 0; }
    </style>
    <script src="d3.min.js" type="text/javascript"></script>
  </head>
  <body>
    <div id="wrapper">
      <h1>Routes FSM with NFA simulation</h1>
      <div class="instruction form">
        <p>
        Type a route in to the box and click "simulate".
        </p>
        <form onsubmit="return match(this.route.value);">
          <input type="text" size="30" name="route" value="/articles/new" />
          <button>simulate</button>
          <input type="reset" value="reset" onclick="return reset_graph();"/>
        </form>
        <p class="fun_routes">
          Some fun routes to try:

             <a href="#" onclick="document.forms[0].elements[0].value=this.text.replace(/^\s+|\s+$/g,''); return match(this.text.replace(/^\s+|\s+$/g,''));">
               /
             </a>

             <a href="#" onclick="document.forms[0].elements[0].value=this.text.replace(/^\s+|\s+$/g,''); return match(this.text.replace(/^\s+|\s+$/g,''));">
               /posts/new.xml
             </a>

             <a href="#" onclick="document.forms[0].elements[0].value=this.text.replace(/^\s+|\s+$/g,''); return match(this.text.replace(/^\s+|\s+$/g,''));">
               /posts.json
             </a>

        </p>
      </div>
      <div class='chart' id='chart-2'>
        <!-- Generated by graphviz version 2.34.0 (20130907.0228) -->
<!-- Title: nfa Pages: 1 -->
<svg viewBox="0.00 0.00 978.00 392.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 388)">
  <title>nfa</title>
  <polygon fill="white" stroke="white" points="-4,4 -4,-388 974,-388 974,4 -4,4"/>
  <!-- 1 -->
  <g id="node1" class="node"><title>1</title>
  <ellipse fill="none" stroke="black" cx="98" cy="-223" rx="18" ry="18"/>
  <ellipse fill="none" stroke="black" cx="98" cy="-223" rx="22" ry="22"/>
  <text text-anchor="middle" x="98" y="-219.3" font-family="Times,serif" font-size="14.00">1</text>
  </g>
  <!-- 2 -->
  <g id="node2" class="node"><title>2</title>
  <ellipse fill="none" stroke="black" cx="208" cy="-261" rx="18" ry="18"/>
  <ellipse fill="none" stroke="black" cx="208" cy="-261" rx="22" ry="22"/>
  <text text-anchor="middle" x="208" y="-257.3" font-family="Times,serif" font-size="14.00">2</text>
  </g>
  <!-- 1->2 -->
  <g id="edge2" class="edge"><title>1->2</title>
  <path fill="none" stroke="black" d="M119.061,-230.058C135.504,-235.844 159.008,-244.114 177.58,-250.649"/>
  <polygon fill="black" stroke="black" points="176.452,-253.962 187.047,-253.979 178.775,-247.359 176.452,-253.962"/>
  <text text-anchor="middle" x="153" y="-250.8" font-family="Times,serif" font-size="14.00">posts</text>
  </g>
  <!-- 3 -->
  <g id="node17" class="node"><title>3</title>
  <ellipse fill="none" stroke="black" cx="208" cy="-199" rx="18" ry="18"/>
  <text text-anchor="middle" x="208" y="-195.3" font-family="Times,serif" font-size="14.00">3</text>
  </g>
  <!-- 1->3 -->
  <g id="edge3" class="edge"><title>1->3</title>
  <path fill="none" stroke="black" d="M119.568,-218.429C136.736,-214.614 161.336,-209.148 180.071,-204.984"/>
  <polygon fill="black" stroke="black" points="181.055,-208.351 190.057,-202.765 179.536,-201.518 181.055,-208.351"/>
  <text text-anchor="middle" x="153" y="-217.8" font-family="Times,serif" font-size="14.00">rails</text>
  </g>
  <!-- 4 -->
  <g id="node18" class="node"><title>4</title>
  <ellipse fill="none" stroke="black" cx="288" cy="-350" rx="18" ry="18"/>
  <text text-anchor="middle" x="288" y="-346.3" font-family="Times,serif" font-size="14.00">4</text>
  </g>
  <!-- 2->4 -->
  <g id="edge4" class="edge"><title>2->4</title>
  <path fill="none" stroke="black" d="M223.306,-277.324C236.115,-291.939 254.96,-313.442 268.831,-329.268"/>
  <polygon fill="black" stroke="black" points="266.349,-331.747 275.572,-336.96 271.613,-327.133 266.349,-331.747"/>
  <text text-anchor="middle" x="250" y="-311.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 5 -->
  <g id="node19" class="node"><title>5</title>
  <ellipse fill="none" stroke="black" cx="288" cy="-261" rx="18" ry="18"/>
  <text text-anchor="middle" x="288" y="-257.3" font-family="Times,serif" font-size="14.00">5</text>
  </g>
  <!-- 2->5 -->
  <g id="edge5" class="edge"><title>2->5</title>
  <path fill="none" stroke="black" d="M230.314,-261C239.359,-261 250.015,-261 259.631,-261"/>
  <polygon fill="black" stroke="black" points="259.907,-264.5 269.907,-261 259.907,-257.5 259.907,-264.5"/>
  <text text-anchor="middle" x="250" y="-264.8" font-family="Times,serif" font-size="14.00">/</text>
  </g>
  <!-- 7 -->
  <g id="node3" class="node"><title>7</title>
  <ellipse fill="none" stroke="black" cx="450" cy="-362" rx="18" ry="18"/>
  <ellipse fill="none" stroke="black" cx="450" cy="-362" rx="22" ry="22"/>
  <text text-anchor="middle" x="450" y="-358.3" font-family="Times,serif" font-size="14.00">7</text>
  </g>
  <!-- 8 -->
  <g id="node4" class="node"><title>8</title>
  <ellipse fill="none" stroke="black" cx="450" cy="-300" rx="18" ry="18"/>
  <ellipse fill="none" stroke="black" cx="450" cy="-300" rx="22" ry="22"/>
  <text text-anchor="middle" x="450" y="-296.3" font-family="Times,serif" font-size="14.00">8</text>
  </g>
  <!-- 11 -->
  <g id="node21" class="node"><title>11</title>
  <ellipse fill="none" stroke="black" cx="534" cy="-348" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="534" y="-344.3" font-family="Times,serif" font-size="14.00">11</text>
  </g>
  <!-- 8->11 -->
  <g id="edge9" class="edge"><title>8->11</title>
  <path fill="none" stroke="black" d="M469.607,-310.892C480.753,-317.416 495.083,-325.805 507.299,-332.955"/>
  <polygon fill="black" stroke="black" points="505.742,-336.099 516.14,-338.131 509.278,-330.058 505.742,-336.099"/>
  <text text-anchor="middle" x="494" y="-328.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 9 -->
  <g id="node5" class="node"><title>9</title>
  <ellipse fill="none" stroke="black" cx="450" cy="-238" rx="18" ry="18"/>
  <ellipse fill="none" stroke="black" cx="450" cy="-238" rx="22" ry="22"/>
  <text text-anchor="middle" x="450" y="-234.3" font-family="Times,serif" font-size="14.00">9</text>
  </g>
  <!-- 12 -->
  <g id="node22" class="node"><title>12</title>
  <ellipse fill="none" stroke="black" cx="534" cy="-284" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="534" y="-280.3" font-family="Times,serif" font-size="14.00">12</text>
  </g>
  <!-- 9->12 -->
  <g id="edge10" class="edge"><title>9->12</title>
  <path fill="none" stroke="black" d="M469.607,-248.438C480.753,-254.691 495.083,-262.73 507.299,-269.582"/>
  <polygon fill="black" stroke="black" points="505.706,-272.702 516.14,-274.542 509.131,-266.597 505.706,-272.702"/>
  <text text-anchor="middle" x="494" y="-266.8" font-family="Times,serif" font-size="14.00">/</text>
  </g>
  <!-- 13 -->
  <g id="node23" class="node"><title>13</title>
  <ellipse fill="none" stroke="black" cx="534" cy="-224" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="534" y="-220.3" font-family="Times,serif" font-size="14.00">13</text>
  </g>
  <!-- 9->13 -->
  <g id="edge11" class="edge"><title>9->13</title>
  <path fill="none" stroke="black" d="M472.117,-234.395C481.797,-232.742 493.429,-230.756 503.92,-228.965"/>
  <polygon fill="black" stroke="black" points="504.649,-232.391 513.917,-227.258 503.47,-225.491 504.649,-232.391"/>
  <text text-anchor="middle" x="494" y="-234.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 10 -->
  <g id="node6" class="node"><title>10</title>
  <ellipse fill="none" stroke="black" cx="450" cy="-129" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="450" cy="-129" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="450" y="-125.3" font-family="Times,serif" font-size="14.00">10</text>
  </g>
  <!-- 14 -->
  <g id="node24" class="node"><title>14</title>
  <ellipse fill="none" stroke="black" cx="534" cy="-129" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="534" y="-125.3" font-family="Times,serif" font-size="14.00">14</text>
  </g>
  <!-- 10->14 -->
  <g id="edge12" class="edge"><title>10->14</title>
  <path fill="none" stroke="black" d="M474.279,-129C483.458,-129 494.106,-129 503.793,-129"/>
  <polygon fill="black" stroke="black" points="503.814,-132.5 513.813,-129 503.813,-125.5 503.814,-132.5"/>
  <text text-anchor="middle" x="494" y="-132.8" font-family="Times,serif" font-size="14.00">/</text>
  </g>
  <!-- 15 -->
  <g id="node25" class="node"><title>15</title>
  <ellipse fill="none" stroke="black" cx="534" cy="-34" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="534" y="-30.3" font-family="Times,serif" font-size="14.00">15</text>
  </g>
  <!-- 10->15 -->
  <g id="edge13" class="edge"><title>10->15</title>
  <path fill="none" stroke="black" d="M466.424,-111.131C479.74,-95.7038 499.049,-73.3329 513.448,-56.6523"/>
  <polygon fill="black" stroke="black" points="516.189,-58.8331 520.073,-48.9761 510.89,-54.2592 516.189,-58.8331"/>
  <text text-anchor="middle" x="494" y="-85.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 16 -->
  <g id="node7" class="node"><title>16</title>
  <ellipse fill="none" stroke="black" cx="698" cy="-354" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="698" cy="-354" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="698" y="-350.3" font-family="Times,serif" font-size="14.00">16</text>
  </g>
  <!-- 17 -->
  <g id="node8" class="node"><title>17</title>
  <ellipse fill="none" stroke="black" cx="698" cy="-288" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="698" cy="-288" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="698" y="-284.3" font-family="Times,serif" font-size="14.00">17</text>
  </g>
  <!-- 22 -->
  <g id="node26" class="node"><title>22</title>
  <ellipse fill="none" stroke="black" cx="782" cy="-288" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="782" y="-284.3" font-family="Times,serif" font-size="14.00">22</text>
  </g>
  <!-- 17->22 -->
  <g id="edge17" class="edge"><title>17->22</title>
  <path fill="none" stroke="black" d="M722.279,-288C731.458,-288 742.106,-288 751.793,-288"/>
  <polygon fill="black" stroke="black" points="751.814,-291.5 761.813,-288 751.813,-284.5 751.814,-291.5"/>
  <text text-anchor="middle" x="742" y="-291.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 18 -->
  <g id="node9" class="node"><title>18</title>
  <ellipse fill="none" stroke="black" cx="698" cy="-222" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="698" cy="-222" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="698" y="-218.3" font-family="Times,serif" font-size="14.00">18</text>
  </g>
  <!-- 19 -->
  <g id="node10" class="node"><title>19</title>
  <ellipse fill="none" stroke="black" cx="698" cy="-156" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="698" cy="-156" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="698" y="-152.3" font-family="Times,serif" font-size="14.00">19</text>
  </g>
  <!-- 23 -->
  <g id="node27" class="node"><title>23</title>
  <ellipse fill="none" stroke="black" cx="782" cy="-156" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="782" y="-152.3" font-family="Times,serif" font-size="14.00">23</text>
  </g>
  <!-- 19->23 -->
  <g id="edge18" class="edge"><title>19->23</title>
  <path fill="none" stroke="black" d="M722.279,-156C731.458,-156 742.106,-156 751.793,-156"/>
  <polygon fill="black" stroke="black" points="751.814,-159.5 761.813,-156 751.813,-152.5 751.814,-159.5"/>
  <text text-anchor="middle" x="742" y="-159.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 20 -->
  <g id="node11" class="node"><title>20</title>
  <ellipse fill="none" stroke="black" cx="698" cy="-90" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="698" cy="-90" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="698" y="-86.3" font-family="Times,serif" font-size="14.00">20</text>
  </g>
  <!-- 24 -->
  <g id="node28" class="node"><title>24</title>
  <ellipse fill="none" stroke="black" cx="782" cy="-90" rx="20.2975" ry="20.2975"/>
  <text text-anchor="middle" x="782" y="-86.3" font-family="Times,serif" font-size="14.00">24</text>
  </g>
  <!-- 20->24 -->
  <g id="edge19" class="edge"><title>20->24</title>
  <path fill="none" stroke="black" d="M722.279,-90C731.458,-90 742.106,-90 751.793,-90"/>
  <polygon fill="black" stroke="black" points="751.814,-93.5001 761.813,-90 751.813,-86.5001 751.814,-93.5001"/>
  <text text-anchor="middle" x="742" y="-93.8" font-family="Times,serif" font-size="14.00">.</text>
  </g>
  <!-- 21 -->
  <g id="node12" class="node"><title>21</title>
  <ellipse fill="none" stroke="black" cx="698" cy="-24" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="698" cy="-24" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="698" y="-20.3" font-family="Times,serif" font-size="14.00">21</text>
  </g>
  <!-- 25 -->
  <g id="node13" class="node"><title>25</title>
  <ellipse fill="none" stroke="black" cx="946" cy="-288" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="946" cy="-288" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="946" y="-284.3" font-family="Times,serif" font-size="14.00">25</text>
  </g>
  <!-- 26 -->
  <g id="node14" class="node"><title>26</title>
  <ellipse fill="none" stroke="black" cx="946" cy="-156" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="946" cy="-156" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="946" y="-152.3" font-family="Times,serif" font-size="14.00">26</text>
  </g>
  <!-- 27 -->
  <g id="node15" class="node"><title>27</title>
  <ellipse fill="none" stroke="black" cx="946" cy="-90" rx="20.2726" ry="20.2726"/>
  <ellipse fill="none" stroke="black" cx="946" cy="-90" rx="24.2973" ry="24.2973"/>
  <text text-anchor="middle" x="946" y="-86.3" font-family="Times,serif" font-size="14.00">27</text>
  </g>
  <!-- 0 -->
  <g id="node16" class="node"><title>0</title>
  <ellipse fill="none" stroke="black" cx="18" cy="-223" rx="18" ry="18"/>
  <text text-anchor="middle" x="18" y="-219.3" font-family="Times,serif" font-size="14.00">0</text>
  </g>
  <!-- 0->1 -->
  <g id="edge1" class="edge"><title>0->1</title>
  <path fill="none" stroke="black" d="M36.3107,-223C44.9715,-223 55.7247,-223 65.7628,-223"/>
  <polygon fill="black" stroke="black" points="65.8471,-226.5 75.8471,-223 65.847,-219.5 65.8471,-226.5"/>
  <text text-anchor="middle" x="56" y="-226.8" font-family="Times,serif" font-size="14.00">/</text>
  </g>
  <!-- 6 -->
  <g id="node20" class="node"><title>6</title>
  <ellipse fill="none" stroke="black" cx="288" cy="-196" rx="18" ry="18"/>
  <text text-anchor="middle" x="288" y="-192.3" font-family="Times,serif" font-size="14.00">6</text>
  </g>
  <!-- 3->6 -->
  <g id="edge6" class="edge"><title>3->6</title>
  <path fill="none" stroke="black" d="M226.311,-198.334C236.174,-197.955 248.752,-197.471 259.896,-197.042"/>
  <polygon fill="black" stroke="black" points="260.148,-200.535 270.006,-196.654 259.879,-193.541 260.148,-200.535"/>
  <text text-anchor="middle" x="250" y="-201.8" font-family="Times,serif" font-size="14.00">/</text>
  </g>
  <!-- 4->7 -->
  <g id="edge20" class="edge"><title>4->7</title>
  <path fill="none" stroke="black" d="M306.123,-351.284C332.747,-353.281 384.471,-357.16 417.837,-359.663"/>
  <polygon fill="black" stroke="black" points="417.736,-363.165 427.97,-360.423 418.26,-356.185 417.736,-363.165"/>
  <text text-anchor="middle" x="366" y="-361.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 5->8 -->
  <g id="edge7" class="edge"><title>5->8</title>
  <path fill="none" stroke="black" d="M305.82,-265.1C332.578,-271.622 385.226,-284.455 418.683,-292.61"/>
  <polygon fill="black" stroke="black" points="417.856,-296.011 428.4,-294.979 419.513,-289.21 417.856,-296.011"/>
  <text text-anchor="middle" x="366" y="-292.8" font-family="Times,serif" font-size="14.00">new</text>
  </g>
  <!-- 5->9 -->
  <g id="edge21" class="edge"><title>5->9</title>
  <path fill="none" stroke="black" d="M305.239,-255.722C311.097,-253.988 317.795,-252.199 324,-251 355.49,-244.912 392.032,-241.53 417.44,-239.752"/>
  <polygon fill="black" stroke="black" points="417.851,-243.233 427.601,-239.086 417.393,-236.248 417.851,-243.233"/>
  <text text-anchor="middle" x="366" y="-254.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 6->10 -->
  <g id="edge8" class="edge"><title>6->10</title>
  <path fill="none" stroke="black" d="M304.926,-189.331C331.185,-178.335 384.023,-156.209 417.893,-142.026"/>
  <polygon fill="black" stroke="black" points="419.453,-145.167 427.325,-138.076 416.75,-138.71 419.453,-145.167"/>
  <text text-anchor="middle" x="366" y="-183.8" font-family="Times,serif" font-size="14.00">info</text>
  </g>
  <!-- 11->16 -->
  <g id="edge22" class="edge"><title>11->16</title>
  <path fill="none" stroke="black" d="M554.22,-348.712C581.143,-349.709 630.487,-351.537 663.52,-352.76"/>
  <polygon fill="black" stroke="black" points="663.499,-356.262 673.622,-353.134 663.759,-349.266 663.499,-356.262"/>
  <text text-anchor="middle" x="614" y="-355.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 12->17 -->
  <g id="edge14" class="edge"><title>12->17</title>
  <path fill="none" stroke="black" d="M554.22,-284.475C581.143,-285.139 630.487,-286.358 663.52,-287.173"/>
  <polygon fill="black" stroke="black" points="663.539,-290.675 673.622,-287.423 663.712,-283.677 663.539,-290.675"/>
  <text text-anchor="middle" x="614" y="-290.8" font-family="Times,serif" font-size="14.00">edit</text>
  </g>
  <!-- 13->18 -->
  <g id="edge23" class="edge"><title>13->18</title>
  <path fill="none" stroke="black" d="M554.22,-223.763C581.143,-223.43 630.487,-222.821 663.52,-222.413"/>
  <polygon fill="black" stroke="black" points="663.666,-225.912 673.622,-222.289 663.58,-218.912 663.666,-225.912"/>
  <text text-anchor="middle" x="614" y="-227.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 14->19 -->
  <g id="edge15" class="edge"><title>14->19</title>
  <path fill="none" stroke="black" d="M553.901,-132.15C580.863,-136.644 630.767,-144.961 663.931,-150.488"/>
  <polygon fill="black" stroke="black" points="663.62,-153.985 674.059,-152.177 664.771,-147.08 663.62,-153.985"/>
  <text text-anchor="middle" x="614" y="-152.8" font-family="Times,serif" font-size="14.00">properties</text>
  </g>
  <!-- 14->20 -->
  <g id="edge16" class="edge"><title>14->20</title>
  <path fill="none" stroke="black" d="M553.334,-122.649C559.254,-120.708 565.871,-118.651 572,-117 602.9,-108.675 638.632,-101.165 663.958,-96.1915"/>
  <polygon fill="black" stroke="black" points="664.643,-99.624 673.794,-94.2848 663.31,-92.752 664.643,-99.624"/>
  <text text-anchor="middle" x="614" y="-120.8" font-family="Times,serif" font-size="14.00">routes</text>
  </g>
  <!-- 15->21 -->
  <g id="edge24" class="edge"><title>15->21</title>
  <path fill="none" stroke="black" d="M554.22,-32.8136C581.219,-31.147 630.765,-28.0886 663.798,-26.0495"/>
  <polygon fill="black" stroke="black" points="664.128,-29.5359 673.893,-25.4264 663.696,-22.5492 664.128,-29.5359"/>
  <text text-anchor="middle" x="614" y="-35.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 22->25 -->
  <g id="edge25" class="edge"><title>22->25</title>
  <path fill="none" stroke="black" d="M802.22,-288C829.143,-288 878.487,-288 911.52,-288"/>
  <polygon fill="black" stroke="black" points="911.622,-291.5 921.622,-288 911.622,-284.5 911.622,-291.5"/>
  <text text-anchor="middle" x="862" y="-291.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 23->26 -->
  <g id="edge26" class="edge"><title>23->26</title>
  <path fill="none" stroke="black" d="M802.22,-156C829.143,-156 878.487,-156 911.52,-156"/>
  <polygon fill="black" stroke="black" points="911.622,-159.5 921.622,-156 911.622,-152.5 911.622,-159.5"/>
  <text text-anchor="middle" x="862" y="-159.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  <!-- 24->27 -->
  <g id="edge27" class="edge"><title>24->27</title>
  <path fill="none" stroke="black" d="M802.22,-90C829.143,-90 878.487,-90 911.52,-90"/>
  <polygon fill="black" stroke="black" points="911.622,-93.5001 921.622,-90 911.622,-86.5001 911.622,-93.5001"/>
  <text text-anchor="middle" x="862" y="-93.8" font-family="Times,serif" font-size="14.00">(?&#45;mix:[^./?]+)</text>
  </g>
  </g>
</svg>

      </div>
      <div class="instruction">
        <p>
        This is a FSM for a system that has the following routes:
        </p>
        <ul>

            <li>/posts(.:format)</li>

            <li>/posts/new(.:format)</li>

            <li>/posts/:id/edit(.:format)</li>

            <li>/posts/:id(.:format)</li>

            <li>/</li>

            <li>/rails/info/properties(.:format)</li>

            <li>/rails/info/routes(.:format)</li>

            <li>/rails/info(.:format)</li>

        </ul>
      </div>
    </div>

      <script>function tt() { return {"regexp_states":{"4":{"[^\\./\\?]+":7},"5":{"[^\\./\\?]+":9},"11":{"[^\\./\\?]+":16},"13":{"[^\\./\\?]+":18},"15":{"[^\\./\\?]+":21},"22":{"[^\\./\\?]+":25},"23":{"[^\\./\\?]+":26},"24":{"[^\\./\\?]+":27}},"string_states":{"0":{"/":1},"1":{"posts":2,"rails":3},"2":{".":4,"/":5},"3":{"/":6},"5":{"new":8},"6":{"info":10},"8":{".":11},"9":{"/":12,".":13},"10":{"/":14,".":15},"12":{"edit":17},"14":{"properties":19,"routes":20},"17":{".":22},"19":{".":23},"20":{".":24}},"accepting":{"1":true,"2":true,"7":true,"8":true,"9":true,"10":true,"16":true,"17":true,"18":true,"19":true,"20":true,"21":true,"25":true,"26":true,"27":true}}; }</script>

      <script>function tokenize(input, callback) {
  while(input.length > 0) {
    callback(input.match(/^[\/\.\?]|[^\/\.\?]+/)[0]);
    input = input.replace(/^[\/\.\?]|[^\/\.\?]+/, '');
  }
}

var graph = d3.select("#chart-2 svg");
var svg_edges = {};
var svg_nodes = {};

graph.selectAll("g.edge").each(function() {
  var node  = d3.select(this);
  var index = node.select("title").text().split("->");
  var left  = parseInt(index[0]);
  var right = parseInt(index[1]);

  if(!svg_edges[left]) { svg_edges[left] = {} }
  svg_edges[left][right] = node;
});

graph.selectAll("g.node").each(function() {
  var node  = d3.select(this);
  var index = parseInt(node.select("title").text());
  svg_nodes[index] = node;
});

function reset_graph() {
  for(var key in svg_edges) {
    for(var mkey in svg_edges[key]) {
      var node = svg_edges[key][mkey];
      var path = node.select("path");
      var arrow = node.select("polygon");
      path.style("stroke", "black");
      arrow.style("stroke", "black").style("fill", "black");
    }
  }

  for(var key in svg_nodes) {
    var node = svg_nodes[key];
    node.select('ellipse').style("fill", "white");
    node.select('polygon').style("fill", "white");
  }
  return false;
}

function highlight_edge(from, to) {
  var node = svg_edges[from][to];
  var path = node.select("path");
  var arrow = node.select("polygon");

  path
    .transition().duration(500)
    .style("stroke", "green");

  arrow
    .transition().duration(500)
    .style("stroke", "green").style("fill", "green");
}

function highlight_state(index, color) {
  if(!color) { color = "green"; }

  svg_nodes[index].select('ellipse')
    .style("fill", "white")
    .transition().duration(500)
    .style("fill", color);
}

function highlight_finish(index) {
  svg_nodes[index].select('polygon')
    .style("fill", "while")
    .transition().duration(500)
    .style("fill", "blue");
}

function match(input) {
  reset_graph();
  var table         = tt();
  var states        = [0];
  var regexp_states = table['regexp_states'];
  var string_states = table['string_states'];
  var accepting     = table['accepting'];

  highlight_state(0);

  tokenize(input, function(token) {
    var new_states = [];
    for(var key in states) {
      var state = states[key];

      if(string_states[state] && string_states[state][token]) {
        var new_state = string_states[state][token];
        highlight_edge(state, new_state);
        highlight_state(new_state);
        new_states.push(new_state);
      }

      if(regexp_states[state]) {
        for(var key in regexp_states[state]) {
          var re = new RegExp("^" + key + "$");
          if(re.test(token)) {
            var new_state = regexp_states[state][key];
            highlight_edge(state, new_state);
            highlight_state(new_state);
            new_states.push(new_state);
          }
        }
      }
    }

    if(new_states.length == 0) {
      return;
    }
    states = new_states;
  });

  for(var key in states) {
    var state = states[key];
    if(accepting[state]) {
      for(var mkey in svg_edges[state]) {
        if(!regexp_states[mkey] && !string_states[mkey]) {
          highlight_edge(state, mkey);
          highlight_finish(mkey);
        }
      }
    } else {
      highlight_state(state, "red");
    }
  }

  return false;
}

</script>
  </body>
</html>
